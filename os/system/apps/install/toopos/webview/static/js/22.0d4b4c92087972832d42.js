webpackJsonp([22],{176:function(t,e){t.exports=function(t,e,n,o,i){var r,a=t=t||{},l=typeof t.default;"object"!==l&&"function"!==l||(r=t,a=t.default);var u="function"==typeof a?a.options:a;e&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns),o&&(u._scopeId=o);var s;if(i?(s=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},u._ssrRegister=s):n&&(s=n),s){var p=u.functional,c=p?u.render:u.beforeCreate;p?u.render=function(t,e){return s.call(e),c(t,e)}:u.beforeCreate=c?[].concat(c,s):[s]}return{esModule:r,exports:a,options:u}}},177:function(t,e,n){var o=n(176)(n(184),null,null,null,null);t.exports=o.exports},178:function(t,e,n){var o=n(176)(n(185),null,null,null,null);t.exports=o.exports},179:function(t,e,n){var o=n(176)(n(182),null,null,null,null);t.exports=o.exports},180:function(t,e,n){var o=n(176)(n(183),null,null,null,null);t.exports=o.exports},182:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(93).then(function(){var e=[n(200)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Content:o}},183:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(10).then(function(){var e=[n(197)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(78).then(function(){var e=[n(201)];t.apply(null,e)}.bind(this)).catch(n.oe)},r=function(t){return n.e(6).then(function(){var e=[n(198)];t.apply(null,e)}.bind(this)).catch(n.oe)},a=function(t){return n.e(8).then(function(){var e=[n(199)];t.apply(null,e)}.bind(this)).catch(n.oe)},l=function(t){return n.e(84).then(function(){var e=[n(202)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Header:o,SecondHeader:i,HeaderLink:r,HeaderTitle:a,SimpleHeader:l,Title:a}},184:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(91).then(function(){var e=[n(203)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Icon:o}},185:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(77).then(function(){var e=[n(205)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(95).then(function(){var e=[n(206)];t.apply(null,e)}.bind(this)).catch(n.oe)},r=function(t){return n.e(70).then(function(){var e=[n(204)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Button:o,CDButton:i,ButtonGroup:r}},186:function(t,e,n){var o=n(176)(n(188),null,null,null,null);t.exports=o.exports},187:function(t,e,n){var o=n(176)(n(189),null,null,null,null);t.exports=o.exports},188:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(79).then(function(){var e=[n(207)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Posts:o}},189:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(76).then(function(){var e=[n(210)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(89).then(function(){var e=[n(209)];t.apply(null,e)}.bind(this)).catch(n.oe)},r=function(t){return n.e(90).then(function(){var e=[n(208)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={List:o,ListItem:i,ListInput:r}},190:function(t,e,n){var o=n(176)(n(191),null,null,null,null);t.exports=o.exports},191:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(80).then(function(){var e=[n(213)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(81).then(function(){var e=[n(215)];t.apply(null,e)}.bind(this)).catch(n.oe)},r=function(t){return n.e(96).then(function(){var e=[n(214)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Footer:o,SecondFooter:i,FooterItem:r,Item:r}},192:function(t,e,n){var o=n(176)(n(193),null,null,null,null);t.exports=o.exports},193:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(7).then(function(){var e=[n(211)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(9).then(function(){var e=[n(212)];t.apply(null,e)}.bind(this)).catch(n.oe)},r=function(t){return n.e(94).then(function(){var e=[n(216)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Column:o,ColumnItem:i,ColumnSort:r}},244:function(t,e,n){var o=n(176)(n(248),null,null,null,null);t.exports=o.exports},246:function(t,e,n){var o=n(176)(n(249),null,null,null,null);t.exports=o.exports},248:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(86).then(function(){var e=[n(267)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Settle:o}},249:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(65).then(function(){var e=[n(268)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(88).then(function(){var e=[n(269)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Tab:o,TabItem:i}},264:function(t,e,n){var o=n(176)(n(273),null,null,null,null);t.exports=o.exports},273:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(85).then(function(){var e=[n(287)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(92).then(function(){var e=[n(286)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Cropper:o,Cropbtn:i}},401:function(t,e,n){var o=n(176)(n(734),n(496),null,null,null);t.exports=o.exports},496:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page"},[n("page-header",{slot:"header"},[n("header-title",[t._v(t._s(t.$t("admin.bopadd.title")))]),t._v(" "),n("header-link",{attrs:{isback:!0,left:!0}},[n("icon",{staticClass:"font08",attrs:{icon:"arrowleft"}}),t._v(t._s(t.$t("default.back")))],1)],1),t._v(" "),n("page-content",{attrs:{ispadding:!0}},[n("vue-form",{attrs:{state:t.vstate},on:{submit:function(e){e.preventDefault(),t.onSubmit()}}},[n("column",{attrs:{num:"100"}},[n("list",[n("column",{slot:"title"},[n("span",{staticClass:"pull-left"},[t._v("基本信息")]),t._v(" "),n("span",{staticClass:"color-warning tip pull-right"},[t._v("必填项目 "),n("icon",{attrs:{icon:"notice-fill"}})],1)])],1)],1),t._v(" "),n("column",{staticClass:"deuce"},[n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"门店",isdanger:!t.bop.oShopID,tip:"门店不得为空"}},[t.bop.oShopID?n("select",{directives:[{name:"model",rawName:"v-model",value:t.bop.oShopID,expression:"bop.oShopID"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.bop.oShopID=e.target.multiple?n:n[0]}}},t._l(t.shopList,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.sName))])})):t._e()])],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"类型"}},[n("select",{directives:[{name:"model",rawName:"v-model.number",value:t.bop.nType,expression:"bop.nType",modifiers:{number:!0}}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(e){var n="_value"in e?e._value:e.value;return t._n(n)});t.bop.nType=e.target.multiple?n:n[0]}}},t._l(t.$t("admin.boptypesingle.boptypes"),function(e,o){return n("option",{key:o,domProps:{value:o+1}},[t._v(t._s(e))])}))])],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"分类",isdanger:!t.hascat,tip:"分类不得为空！"}},[t.bop.oBoptypeID?n("select",{directives:[{name:"model",rawName:"v-model",value:t.bop.oBoptypeID,expression:"bop.oBoptypeID"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.bop.oBoptypeID=e.target.multiple?n:n[0]}}},t._l(t.boptypeListFilter,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.sName))])})):t._e(),t._v(" "),n("div",{staticClass:"item-after",slot:"button"},[n("m-button",{attrs:{size:"mini",type:"warning"},nativeOn:{click:function(e){t.goAddBopType()}}},[t._v("新增")])],1)])],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"金额",isdanger:t.vstate.ppmoney&&t.vstate.ppmoney.$invalid,tip:"金额必须为不小于0的数字"}},[n("validate",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.bop.dMoney,expression:"bop.dMoney",modifiers:{number:!0}}],attrs:{name:"ppmoney",type:"text",placeholder:t.$t("admin.bopadd.plbopmoney"),required:"",pattern:"^\\d+(?:\\.\\d{1,2})?$"},domProps:{value:t.bop.dMoney},on:{input:function(e){e.target.composing||(t.bop.dMoney=t._n(e.target.value))},blur:function(e){t.$forceUpdate()}}})])],1)],1)],1)],1),t._v(" "),n("column",[n("list",[n("column",{slot:"title"},[n("span",{staticClass:"pull-left"},[t._v("其它信息")]),t._v(" "),n("span",{staticClass:"color-warning tip pull-right"},[t._v("选填项目 "),n("icon",{attrs:{icon:"notice-fill"}})],1)])],1)],1),t._v(" "),n("column",{staticClass:"deuce"},[n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"备注"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.bop.sTag,expression:"bop.sTag"}],attrs:{name:"ppname",type:"text",placeholder:t.$t("admin.bopadd.plboptag")},domProps:{value:t.bop.sTag},on:{input:function(e){e.target.composing||(t.bop.sTag=e.target.value)}}})])],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"封面"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.sCoverImage,expression:"sCoverImage"}],attrs:{name:"ppcoverimg",type:"text",placeholder:t.$t("admin.bopadd.plbopcoverimg")},domProps:{value:t.sCoverImage},on:{input:function(e){e.target.composing||(t.sCoverImage=e.target.value)}}}),t._v(" "),n("img",{staticStyle:{width:"4rem",height:"4rem"},attrs:{src:t.sCoverImage}}),t._v(" "),n("cropbtn",{on:{imageData:t.imageData}})],1)],1)],1)],1)],1)],1),t._v(" "),n("br"),t._v(" "),n("column",{staticClass:"deuce"},[n("column-item",{attrs:{num:"50"}},[n("m-button",{attrs:{type:"danger"},nativeOn:{click:function(e){t.goback()}}},[t._v("关闭")])],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("m-button",{attrs:{disabled:!t.hascat||t.vstate.$invalid},nativeOn:{click:function(e){t.onSubmit()}}},[t._v("保存")])],1)],1)],1)],1),t._v(" "),n("cropper",{attrs:{show:t.showcrop,cropurl:t.cropurl},on:{closeLsn:t.cropClose,cropData:t.cropData}}),t._v(" "),n("settle",{attrs:{show:t.showSettle,price:""!=t.bop.dMoney?t.bop.dMoney:0,title:t.$t("default.settle.title")},on:{closeLsn:t.settleclose,settleAccount:t.confirmSettle}}),t._v(" "),n("posts",{ref:"posts",on:{mounted:t.mountPost}})],1)},staticRenderFns:[]}},734:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(180),i=n(177),r=n(179),a=n(178),l=n(190),u=n(186),s=n(244),p=n(192),c=n(246),d=n(187),f=n(264);e.default={components:{"page-header":o.Header,"header-link":o.HeaderLink,"header-title":o.HeaderTitle,"page-content":r.Content,"m-button":a.Button,"page-footer":l.Footer,Cropper:f.Cropper,Cropbtn:f.Cropbtn,Icon:i.Icon,Posts:u.Posts,Settle:s.Settle,List:d.List,ListItem:d.ListItem,ListInput:d.ListInput,Column:p.Column,ColumnItem:p.ColumnItem,Tab:c.Tab},data:function(){return{p:"",showcrop:!1,boptypeListIndex:0,leftchecked2:0,cropurl:"",sCoverImage:"",bop:{},boptypeList:[],searchInput2:"",shopList:[],vstate:{},showSettle:!1}},computed:{hascat:function(){for(var t=this.boptypeListFilter,e=0;e<t.length;e++)if(this.bop.oBoptypeID==t[e].id&&t[e].oShopID==this.bop.oShopID)return!0;return t.length>0&&(this.bop.oBoptypeID||(this.bop.oBoptypeID=t[0].id),!0)},boptypeListFilter:function(){var t=this,e=this;return this.boptypeList.filter(function(n){return 1==n.nStatus&&(e.bop.nType==n.nType&&(e.bop.oBoptypeID||(e.bop.oBoptypeID=n.id),n.oShopID==t.bop.oShopID))})}},methods:{mountPost:function(){this.updateRoute()},settleclose:function(){this.showSettle=!1},confirmSettle:function(t){var e=this;t.nType=1==e.bop.nType?3:7,t.sTag=e.bop.sTag,t.settleData=[e.bop],e.$refs.posts&&e.$refs.posts.post(e.$Method.nSaleRecordAdd,t,!0,!0,{sImage:encodeURIComponent(e.sCoverImage)}).then(function(t){e.showSettle=!1,e.goback(!0)})},searchInputLsn:function(t){this.searchInput2=t},tabclick:function(t){this.ontabclick(t)},goAddBopType:function(){this.$router.push({path:"admin_boptype_add",query:{type:this.bop.nType}})},imageData:function(t){this.cropurl=t,this.showcrop=!0},cropClose:function(){this.showcrop=!1},cropData:function(t){this.showcrop=!1,this.sCoverImage=t},goback:function(t){var e=this;t?setTimeout(function(){e.$router.back()},1e3):e.$router.back()},onSubmit:function(){var t=this;this.vstate.$valid&&this.hascat&&(t.bop.dMoney>0?t.showSettle=!0:t.$refs.posts.toastError("金额必须大于0！"))},syncData:function(){var t=this;t.$refs.posts.post(t.$Method.nBoptypeList).then(function(e){try{t.boptypeList=e.arrData.tables.boptype.db}catch(t){}}),t.$refs.posts.post(t.$Method.nShopList).then(function(e){try{t.shopList=e.arrData.tables.shop.db}catch(t){}})},updateRoute:function(){this.bop={oShopID:this.$Cookie.get("cShopID",null),oBoptypeID:this.$route.query.catid,nType:this.$route.query.type?this.$route.query.type:2,sUnit:"",dMoney:"",sCoverImage:"",dMemberPrice:"",dBuyPrice:"",sTag:"",dNumber:""},this.syncData()}},activated:function(){document.title=this.$t("admin.bopadd.title"),this.updateRoute()},watch:{"bop.oShopID":function(t){this.hascat}}}}});