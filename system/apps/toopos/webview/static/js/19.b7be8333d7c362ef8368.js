webpackJsonp([19],{176:function(t,e){t.exports=function(t,e,n,o,r){var i,a=t=t||{},s=typeof t.default;"object"!==s&&"function"!==s||(i=t,a=t.default);var u="function"==typeof a?a.options:a;e&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns),o&&(u._scopeId=o);var l;if(r?(l=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},u._ssrRegister=l):n&&(l=n),l){var c=u.functional,p=c?u.render:u.beforeCreate;c?u.render=function(t,e){return l.call(e),p(t,e)}:u.beforeCreate=p?[].concat(p,l):[l]}return{esModule:i,exports:a,options:u}}},177:function(t,e,n){var o=n(176)(n(184),null,null,null,null);t.exports=o.exports},178:function(t,e,n){var o=n(176)(n(185),null,null,null,null);t.exports=o.exports},179:function(t,e,n){var o=n(176)(n(182),null,null,null,null);t.exports=o.exports},180:function(t,e,n){var o=n(176)(n(183),null,null,null,null);t.exports=o.exports},182:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(93).then(function(){var e=[n(200)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Content:o}},183:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(10).then(function(){var e=[n(197)];t.apply(null,e)}.bind(this)).catch(n.oe)},r=function(t){return n.e(78).then(function(){var e=[n(201)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(6).then(function(){var e=[n(198)];t.apply(null,e)}.bind(this)).catch(n.oe)},a=function(t){return n.e(8).then(function(){var e=[n(199)];t.apply(null,e)}.bind(this)).catch(n.oe)},s=function(t){return n.e(84).then(function(){var e=[n(202)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Header:o,SecondHeader:r,HeaderLink:i,HeaderTitle:a,SimpleHeader:s,Title:a}},184:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(91).then(function(){var e=[n(203)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Icon:o}},185:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(77).then(function(){var e=[n(205)];t.apply(null,e)}.bind(this)).catch(n.oe)},r=function(t){return n.e(95).then(function(){var e=[n(206)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(70).then(function(){var e=[n(204)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Button:o,CDButton:r,ButtonGroup:i}},186:function(t,e,n){var o=n(176)(n(188),null,null,null,null);t.exports=o.exports},187:function(t,e,n){var o=n(176)(n(189),null,null,null,null);t.exports=o.exports},188:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(79).then(function(){var e=[n(207)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Posts:o}},189:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(76).then(function(){var e=[n(210)];t.apply(null,e)}.bind(this)).catch(n.oe)},r=function(t){return n.e(89).then(function(){var e=[n(209)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(90).then(function(){var e=[n(208)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={List:o,ListItem:r,ListInput:i}},190:function(t,e,n){var o=n(176)(n(191),null,null,null,null);t.exports=o.exports},191:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(80).then(function(){var e=[n(213)];t.apply(null,e)}.bind(this)).catch(n.oe)},r=function(t){return n.e(81).then(function(){var e=[n(215)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(96).then(function(){var e=[n(214)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Footer:o,SecondFooter:r,FooterItem:i,Item:i}},192:function(t,e,n){var o=n(176)(n(193),null,null,null,null);t.exports=o.exports},193:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(7).then(function(){var e=[n(211)];t.apply(null,e)}.bind(this)).catch(n.oe)},r=function(t){return n.e(9).then(function(){var e=[n(212)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(94).then(function(){var e=[n(216)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Column:o,ColumnItem:r,ColumnSort:i}},217:function(t,e,n){var o=n(176)(n(218),null,null,null,null);t.exports=o.exports},218:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(71).then(function(){var e=[n(228)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Paginate:o}},223:function(t,e,n){var o=n(176)(n(225),null,null,null,null);t.exports=o.exports},224:function(t,e,n){var o=n(176)(n(226),null,null,null,null);t.exports=o.exports},225:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(62).then(function(){var e=[n(240)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Datetimer:o}},226:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(66).then(function(){var e=[n(241)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Popup:o}},262:function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(42),i=o(r),a=n(43),s=o(a);Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"D+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(Y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t},Date.prototype.subtract=function(t,e){return 0==t?this:(e=e||"days","days"==e||"D"==e?this.setDate(this.getDate()-t):"months"==e||"M"==e?this.setMonth(this.getMonth()-t):"years"!=e&&"Y"!=e||this.setFullYear(this.getFullYear()-t),this)},Date.prototype.add=function(t,e){return this.subtract(-t,e)},Date.prototype.year=function(){return this.getFullYear()},Date.prototype.month=function(){return this.getMonth()},Date.prototype.day=function(){return this.getDay()+1},Date.prototype.date=function(t){var e=new Date(this.getTime());return e.setDate(t-1),e},Date.prototype.daysInMonth=function(){var t=this.add(1,"M");return t.setDate(0),t.getDate()},Date.prototype.isBefore=function(t){return this.getTime()<new Date(t).getTime()},Date.prototype.isAfter=function(t){return this.getTime()>new Date(t).getTime()},Date.prototype.isBetween=function(t,e){return this.isAfter(t)&&this.isBefore(e)};var u=function(){function t(){(0,i.default)(this,t)}return(0,s.default)(t,[{key:"locale",value:function(t){}},{key:"now",value:function(){return new Date}},{key:"diff",value:function(t){try{t=parseInt(t/1e3)}catch(e){t=0}var e=Math.floor(t/86400),n=t-24*e*60*60,o=Math.floor(n/3600),r=t-24*e*60*60-60*o*60,i=Math.floor(r/60),a=t-24*e*60*60-60*o*60-60*i,s="";return e>0&&(s+=e+"天"),(o>0||o<=0&&e>0)&&(s+=o+"小时"),(i>0||i<=0&&(e>0||o>0))&&(s+=i+"分"),(a>0||a<=0&&(e>0||o>0||i>0))&&(s+=a+"秒"),s}},{key:"parse",value:function(t){return new Date(t)}},{key:"from",value:function(t){t=parseInt(t);var e=new Date,n=e.getTime(),o=e.getFullYear(),r=n-t,i=new Date(t),a=i.getFullYear();if(!(r<0)){var s=Math.floor(r/864e5),u=Math.floor(r/36e5),l=Math.floor(r/6e4),c="";if(s>=1){var p=this.format(t,"HH:mm");c=1==s?"昨天 "+p:2==s?"前天 "+p:this.format(t,a==o?"MM-DD HH:mm":"YYYY-MM-DD HH:mm")}else c=u>=1?u+"小时前":l>=1?l+"分钟前":"刚刚";return c}}},{key:"format",value:function(t,e){return e=e||"YYYY-MM-DD HH:mm:ss",this.parse(t).format(e)}},{key:"formatDate",value:function(t,e){var n=[/YYYY|YY/,/MM|M/,/DD|DD/,/HH|H/,/mm|m/,/ss|s/].map(function(n,o){var r=n.exec(e);if(!r)return 0;var i=+t.substring(r.index,r.index+r[0].length);switch(o){case 0:if(!Math.floor(i/100))return 100*Math.floor((new Date).getFullYear()/100)+i;break;case 1:return i-1}return i});return new Date(n[0],n[1],n[2],n[3],n[4],n[5])}}]),t}();e.default=u},426:function(t,e,n){var o=n(176)(n(759),n(483),null,null,null);t.exports=o.exports},483:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page"},[n("page-header",{slot:"header"},[n("header-title",[t._v(t._s(t.$t("admin.stockmanage.title")))]),t._v(" "),n("header-link",{attrs:{isback:!0,left:!0}},[n("icon",{staticClass:"font08",attrs:{icon:"arrowleft"}}),t._v(t._s(t.$t("default.back")))],1),t._v(" "),n("header-link",{on:{linkClick:function(e){t.searchshow=!0}}},[n("icon",{staticClass:"font08",attrs:{icon:"search"}})],1)],1),t._v(" "),n("page-content",{attrs:{ispadding:!0}},[n("list",{attrs:{linktitle:!0}},[n("column-sort",{attrs:{sortdata:[{text:"商品名称",num:"30",key:"sName",class:"text-left"},{text:"数量",num:"10",key:"dSaleNumber",index:1},{text:"总售价",num:"15",key:"dTotleSalePrice"},{text:"实收",num:"15",key:"dPaidMoney"},{text:"总进价",num:"15",key:"dTotleBuyPrice"},{text:"盈利",num:"15",key:"dProfitMoney"}]},on:{sortchange:t.sortChange},slot:"title"}),t._v(" "),t._l(t.pageDataList,function(e,o){return n("list-item",{key:o,attrs:{checktype:"border",link:!0}},[n("router-link",{staticClass:"item-content",attrs:{to:{path:"admin_stock_single",query:{id:e.oProductID,name:e.sName}},tag:"div"}},[n("column",[n("column-item",{class:1==e.nStatus?"text-left":"text-line-through text-left",attrs:{num:"30"}},[n("icon",{attrs:{icon:t.$t("default.producttypeicons")[e.nType-1]}}),t._v(" "+t._s(e.sName)),1!=e.nStatus?n("span",{staticClass:"color-warning"},[t._v("(已删除)")]):t._e()],1),t._v(" "),n("column-item",{attrs:{num:"10"}},[n("div",{staticClass:"badge"},[t._v(t._s(t._f("decimal")(e.dSaleNumber)))])]),t._v(" "),n("column-item",{attrs:{num:"15"}},[n("span",{staticClass:"font05"},[t._v("￥")]),n("font",{staticClass:"font07"},[t._v(t._s(t._f("decimal")(e.dTotleSalePrice)))])],1),t._v(" "),n("column-item",{attrs:{num:"15"}},[n("span",{staticClass:"font05"},[t._v("￥")]),n("font",{staticClass:"font07"},[t._v(t._s(t._f("decimal")(e.dPaidMoney)))])],1),t._v(" "),n("column-item",{attrs:{num:"15"}},[n("span",{staticClass:"font05"},[t._v("￥")]),n("font",{staticClass:"font07"},[t._v(t._s(t._f("decimal")(e.dTotleBuyPrice)))])],1),t._v(" "),n("column-item",{attrs:{num:"15"}},[n("span",{staticClass:"font05"},[t._v("￥")]),n("font",{staticClass:"font07"},[t._v(t._s(t._f("decimal")(e.dProfitMoney)))])],1)],1)],1)],1)}),t._v(" "),n("paginate",{attrs:{data:t.rankListFilter},on:{pagedata:t.pagedata},slot:"paginate"}),t._v(" "),n("column",{staticClass:"color-warning",slot:"append"},[n("column-item",{attrs:{num:"30"}},[t._v("\n                "+t._s(t.totle.nProduct)+"种商品\n              ")]),t._v(" "),n("column-item",{attrs:{num:"10"}},[t._v("\n                "+t._s(t._f("decimal")(t.totle.dSaleNumber))+"\n              ")]),t._v(" "),n("column-item",{attrs:{num:"15"}},[n("span",{staticClass:"font05"},[t._v("￥")]),t._v(t._s(t._f("decimal")(t.totle.dTotleSalePrice))+"\n              ")]),t._v(" "),n("column-item",{attrs:{num:"15"}},[n("span",{staticClass:"font05"},[t._v("￥")]),t._v(t._s(t._f("decimal")(t.totle.dPaidMoney))+"\n              ")]),t._v(" "),n("column-item",{attrs:{num:"15"}},[n("span",{staticClass:"font05"},[t._v("￥")]),t._v(t._s(t._f("decimal")(t.totle.dTotleBuyPrice))+"\n              ")]),t._v(" "),n("column-item",{attrs:{num:"15"}},[n("span",{staticClass:"font05"},[t._v("￥")]),t._v(t._s(t._f("decimal")(t.totle.dProfitMoney))+"\n              ")])],1)],2)],1),t._v(" "),n("popup",{attrs:{show:t.searchshow,ispadding:!0,type:"modal",title:t.$t("default.filter"),"close-button-text":t.$t("default.close"),direction:"fade-center"},on:{closeLsn:t.searchPopClose}},[n("column",{staticClass:"deuce"},[n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"门店"}},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.ppshop,expression:"ppshop"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.ppshop=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"0"}},[t._v("全部门店")]),t._v(" "),t._l(t.shoplist,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.sName))])})],2)])],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"分类"}},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.ppcat,expression:"ppcat"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.ppcat=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"0"}},[t._v("全部分类")]),t._v(" "),t._l(t.categoryList,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.sName))])})],2)])],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"员工"}},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.ppuser,expression:"ppuser"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.ppuser=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"0"}},[t._v("全部员工")]),t._v(" "),t._l(t.userList,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.sName?e.sName:e.sEmail))])})],2)])],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"会员"}},[n("select",{directives:[{name:"model",rawName:"v-model.number",value:t.ppmember,expression:"ppmember",modifiers:{number:!0}}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(e){var n="_value"in e?e._value:e.value;return t._n(n)});t.ppmember=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"0"}},[t._v("全部会员")]),t._v(" "),t._l(t.memberlist,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.nPhone))])})],2)])],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"开始时间"}},[n("datetimer",{attrs:{time:t.ppstarttime,limit:[{type:"fromto",to:t.ppendtime}]},on:{changeLsn:t.ppstarttimechange}})],1)],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"截止时间"}},[n("datetimer",{attrs:{time:t.ppendtime,limit:[{type:"fromto",from:t.ppstarttime}]},on:{changeLsn:t.ppendtimechange}})],1)],1)],1)],1)],1),t._v(" "),n("br"),t._v(" "),n("column",{staticClass:"deuce"},[n("column-item",{attrs:{num:"50"}},[n("m-button",{attrs:{type:"danger"},nativeOn:{click:function(e){t.resetfilter()}}},[t._v("重置")])],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("m-button",{nativeOn:{click:function(e){t.syncRankList()}}},[t._v("提交")])],1)],1)],1),t._v(" "),n("posts",{ref:"posts",on:{mounted:t.mountPost}})],1)},staticRenderFns:[]}},759:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(262),r=function(t){return t&&t.__esModule?t:{default:t}}(o),i=n(180),a=n(177),s=n(179),u=n(178),l=n(190),c=n(186),p=n(217),f=n(192),m=n(187),d=n(223),h=n(224),v=new r.default;e.default={components:{"page-header":i.Header,"header-link":i.HeaderLink,"header-title":i.HeaderTitle,"page-content":s.Content,"m-button":u.Button,"page-footer":l.Footer,Icon:a.Icon,Paginate:p.Paginate,Posts:c.Posts,List:m.List,ListItem:m.ListItem,ListInput:m.ListInput,Column:f.Column,ColumnItem:f.ColumnItem,ColumnSort:f.ColumnSort,Datetimer:d.Datetimer,Popup:h.Popup},computed:{totle:function(){for(var t=this.rankList,e=0,n=0,o=0,r=0,i=0,a=[],s=0,u=0;u<t.length;u++)a.indexOf(t[u].oProductID)<0&&a.push(t[u].oProductID),t[u].nType<=2&&t[u].dMoney<=0&&(s+=t[u].dSurplusNumber),o+=t[u].dTotleSalePrice,e+=t[u].dSaleNumber,n+=t[u].dTotleBuyPrice,r+=t[u].dPaidMoney,i+=t[u].dProfitMoney;return{nProduct:a.length,dSurplusNumber:s,dSaleNumber:e,dTotleSalePrice:o,dTotleBuyPrice:n,dPaidMoney:r,dProfitMoney:i}},rankListFilter:function(){return this.rankList.keysort(this.sortkey,this.sortasc)}},data:function(){return{sortasc:!1,sortkey:"dSaleNumber",searchshow:!1,searchInput:"",rankList:[],shoplist:[],categoryList:[],memberlist:[],userList:[],pageDataList:[],ppshop:"0",ppcat:"0",ppmember:"0",ppuser:"0",ppstarttime:"2000-01-01 00:00",ppendtime:"2100-01-01 00:00"}},methods:{mountPost:function(){this.updateRoute()},updateRoute:function(){this.syncRankList()},pagedata:function(t){this.pageDataList=t},searchPopClose:function(t){this.searchshow=!1},ppstarttimechange:function(t){this.ppstarttime=t},ppendtimechange:function(t){this.ppendtime=t},sortChange:function(t){this.sortkey=t.key,this.sortasc=t.asc},resetfilter:function(){this.ppstarttime="2000-01-01 00:00",this.ppendtime="2100-01-01 00:00",this.ppshop="0",this.ppcat=0,this.ppmember=0,this.ppuser=0},loadfromdb:function(){var t=this;this.$WebStorage.then(function(e){e.select("shop").then(function(e){t.shoplist=e.rows}),e.select("category").then(function(e){t.categoryList=e.rows}),e.select("member").then(function(e){t.memberlist=e.rows}),e.select("user").then(function(e){t.userList=e.rows})})},getProduct:function(t,e){for(var n in t)if(t[n].id==e)return t[n]},syncRankList:function(){var t=this;if(t.$refs.posts){var e={oShopID:this.ppshop,oCategoryID:this.ppcat,oMemberID:this.ppmember,oUserID:this.ppuser,nStartTime:v.formatDate(t.ppstarttime,"YYYY-MM-DD HH:mm").getTime(),nEndTime:v.formatDate(t.ppendtime,"YYYY-MM-DD HH:mm").getTime()};if(e.nStartTime>e.nEndTime)return void t.$refs.posts.toastError("开始时间不得大于截至时间！");t.$refs.posts.post(t.$Method.nStockList,e).then(function(e){var n=e.arrData.list;t.$WebStorage.then(function(e){e.select("product").then(function(e){for(var o=e.rows,r=0;r<n.length;r++){var i=n[r],a=t.getProduct(o,i.oProductID);n[r].nType=a.nType,n[r].nStatus=a.nStatus,n[r].sName=a.sName}t.rankList=n})}),t.searchshow=!1})}}},activated:function(){document.title=this.$t("admin.stockmanage.title"),this.loadfromdb(),this.updateRoute()}}}});