webpackJsonp([16],{176:function(t,e){t.exports=function(t,e,n,o,i){var a,r=t=t||{},s=typeof t.default;"object"!==s&&"function"!==s||(a=t,r=t.default);var l="function"==typeof r?r.options:r;e&&(l.render=e.render,l.staticRenderFns=e.staticRenderFns),o&&(l._scopeId=o);var u;if(i?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},l._ssrRegister=u):n&&(u=n),u){var c=l.functional,p=c?l.render:l.beforeCreate;c?l.render=function(t,e){return u.call(e),p(t,e)}:l.beforeCreate=p?[].concat(p,u):[u]}return{esModule:a,exports:r,options:l}}},177:function(t,e,n){var o=n(176)(n(184),null,null,null,null);t.exports=o.exports},178:function(t,e,n){var o=n(176)(n(185),null,null,null,null);t.exports=o.exports},179:function(t,e,n){var o=n(176)(n(182),null,null,null,null);t.exports=o.exports},180:function(t,e,n){var o=n(176)(n(183),null,null,null,null);t.exports=o.exports},182:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(93).then(function(){var e=[n(200)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Content:o}},183:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(10).then(function(){var e=[n(197)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(78).then(function(){var e=[n(201)];t.apply(null,e)}.bind(this)).catch(n.oe)},a=function(t){return n.e(6).then(function(){var e=[n(198)];t.apply(null,e)}.bind(this)).catch(n.oe)},r=function(t){return n.e(8).then(function(){var e=[n(199)];t.apply(null,e)}.bind(this)).catch(n.oe)},s=function(t){return n.e(84).then(function(){var e=[n(202)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Header:o,SecondHeader:i,HeaderLink:a,HeaderTitle:r,SimpleHeader:s,Title:r}},184:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(91).then(function(){var e=[n(203)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Icon:o}},185:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(77).then(function(){var e=[n(205)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(95).then(function(){var e=[n(206)];t.apply(null,e)}.bind(this)).catch(n.oe)},a=function(t){return n.e(70).then(function(){var e=[n(204)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Button:o,CDButton:i,ButtonGroup:a}},186:function(t,e,n){var o=n(176)(n(188),null,null,null,null);t.exports=o.exports},187:function(t,e,n){var o=n(176)(n(189),null,null,null,null);t.exports=o.exports},188:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(79).then(function(){var e=[n(207)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Posts:o}},189:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(76).then(function(){var e=[n(210)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(89).then(function(){var e=[n(209)];t.apply(null,e)}.bind(this)).catch(n.oe)},a=function(t){return n.e(90).then(function(){var e=[n(208)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={List:o,ListItem:i,ListInput:a}},190:function(t,e,n){var o=n(176)(n(191),null,null,null,null);t.exports=o.exports},191:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(80).then(function(){var e=[n(213)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(81).then(function(){var e=[n(215)];t.apply(null,e)}.bind(this)).catch(n.oe)},a=function(t){return n.e(96).then(function(){var e=[n(214)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Footer:o,SecondFooter:i,FooterItem:a,Item:a}},192:function(t,e,n){var o=n(176)(n(193),null,null,null,null);t.exports=o.exports},193:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(7).then(function(){var e=[n(211)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(9).then(function(){var e=[n(212)];t.apply(null,e)}.bind(this)).catch(n.oe)},a=function(t){return n.e(94).then(function(){var e=[n(216)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Column:o,ColumnItem:i,ColumnSort:a}},223:function(t,e,n){var o=n(176)(n(225),null,null,null,null);t.exports=o.exports},224:function(t,e,n){var o=n(176)(n(226),null,null,null,null);t.exports=o.exports},225:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(62).then(function(){var e=[n(240)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Datetimer:o}},226:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(66).then(function(){var e=[n(241)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Popup:o}},252:function(t,e,n){var o=n(176)(n(260),null,null,null,null);t.exports=o.exports},253:function(t,e,n){var o=n(176)(n(261),null,null,null,null);t.exports=o.exports},260:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(11).then(function(){var e=[n(274)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={Echarts:o}},261:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return n.e(61).then(function(){var e=[n(276)];t.apply(null,e)}.bind(this)).catch(n.oe)},i=function(t){return n.e(83).then(function(){var e=[n(275)];t.apply(null,e)}.bind(this)).catch(n.oe)};e.default={PageMenu:o,PageMenuItem:i}},423:function(t,e,n){var o=n(176)(n(756),n(476),null,null,null);t.exports=o.exports},476:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page"},[n("page-header",{slot:"header"},[n("header-title",[t._v(t._s(t.$t("admin.shoprank.title"))+" "),n("span",{staticClass:"color-warning",attrs:{id:"rankedit"}},[t._v(t._s(t.$t("admin.shoprank.arrDate["+t.nDateType+"]"))+" "),n("icon",{staticClass:"font07",attrs:{icon:"arrowdown"}})],1)]),t._v(" "),n("page-menu",{attrs:{trigger:"#rankedit",show:t.pmshow},on:{toggle:t.toggleMenu}},t._l(t.$t("admin.shoprank.arrDate"),function(e,o){return n("page-menu-item",{key:o,nativeOn:{click:function(e){t.switchDate(o)}}},[t._v(t._s(e))])})),t._v(" "),n("header-link",{attrs:{isback:!0,left:!0}},[n("icon",{attrs:{icon:"arrowleft"}}),t._v(t._s(t.$t("default.back")))],1),t._v(" "),n("header-link",{on:{linkClick:function(e){t.searchshow=!0}}},[n("icon",{staticClass:"font08",attrs:{icon:"search"}})],1)],1),t._v(" "),n("page-content",{attrs:{ispadding:!0}},[n("echarts",{attrs:{option:t.eoption},on:{ready:t.onEchartReady}})],1),t._v(" "),n("popup",{attrs:{show:t.searchshow,ispadding:!0,type:"modal",title:t.$t("default.filter"),"close-button-text":t.$t("default.close"),direction:"fade-center"},on:{closeLsn:t.searchPopClose}},[n("column",{staticClass:"deuce"},[n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"门店"}},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.ppshop,expression:"ppshop"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.ppshop=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"0"}},[t._v("全部门店")]),t._v(" "),t._l(t.shoplist,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.sName))])})],2)])],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"分类"}},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.ppcat,expression:"ppcat"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.ppcat=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"0"}},[t._v("全部分类")]),t._v(" "),t._l(t.categoryList,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.sName))])})],2)])],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"员工"}},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.ppuser,expression:"ppuser"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.ppuser=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"0"}},[t._v("全部员工")]),t._v(" "),t._l(t.userlist,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(null!=e.sName?e.sName:e.sEmail))])})],2)])],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"会员"}},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.ppmember,expression:"ppmember"}],on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.ppmember=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"0"}},[t._v("全部会员")]),t._v(" "),t._l(t.memberlist,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.nPhone))])})],2)])],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"开始时间"}},[n("datetimer",{attrs:{time:t.ppstarttime,limit:[{type:"fromto",to:t.ppendtime}]},on:{changeLsn:t.ppstarttimechange}})],1)],1)],1)],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("list",[n("list-item",[n("list-input",{attrs:{title:"截止时间"}},[n("datetimer",{attrs:{time:t.ppendtime,limit:[{type:"fromto",from:t.ppstarttime}]},on:{changeLsn:t.ppendtimechange}})],1)],1)],1)],1)],1),t._v(" "),n("br"),t._v(" "),n("column",{staticClass:"deuce"},[n("column-item",{attrs:{num:"50"}},[n("m-button",{attrs:{type:"danger"},nativeOn:{click:function(e){t.resetfilter()}}},[t._v("重置")])],1),t._v(" "),n("column-item",{attrs:{num:"50"}},[n("m-button",{nativeOn:{click:function(e){t.syncRanklist(!0)}}},[t._v("提交")])],1)],1)],1),t._v(" "),n("posts",{ref:"posts",on:{mounted:t.mountPost}})],1)},staticRenderFns:[]}},756:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(180),i=n(177),a=n(179),r=n(178),s=n(190),l=n(186),u=n(223),c=n(224),p=n(192),h=n(187),d=n(253),m=n(252);e.default={components:{"page-header":o.Header,"header-link":o.HeaderLink,"header-title":o.HeaderTitle,"page-content":a.Content,"m-button":r.Button,"page-footer":s.Footer,Icon:i.Icon,Echarts:m.Echarts,Posts:l.Posts,Datetimer:u.Datetimer,Popup:c.Popup,List:h.List,ListItem:h.ListItem,ListInput:h.ListInput,Column:p.Column,ColumnItem:p.ColumnItem,"page-menu":d.PageMenu,"page-menu-item":d.PageMenuItem},data:function(){return{sResultStartTime:"",sResultEndTime:"",arrDateNum:[100,1,6,3,1,7,1,1],arrDateAdd:["years","years","months","months","months","days","days","hours"],nDateType:0,sFomat:"YYYY-MM-DD HH:mm",searchshow:!1,pmshow:!1,shoplist:[],categoryList:[],memberlist:[],shopList:[],userlist:[],arrShopID:[],ppshop:"0",ppcat:"0",ppmember:"0",ppuser:"0",ppstarttime:"2000-01-01 00:00",ppendtime:"2100-01-01 00:00",eoption:{title:{text:"",subtext:"",x:"4%",textStyle:{fontSize:"18"},subtextStyle:{color:"#999",fontSize:"14"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},toolbox:{show:!0,feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},magicType:{type:["bar","line"]},restore:{},saveAsImage:{}}},grid:{borderWidth:0,top:110,bottom:95,containLabel:!0},legend:{x:"4%",top:"11%",textStyle:{color:"#0894ec"},data:["盈利","进价","实收"]},calculable:!0,xAxis:[{type:"category",data:[],boundaryGap:!1}],yAxis:[{type:"value",splitLine:{show:!1},axisTick:{show:!1},axisLabel:{interval:0},splitArea:{show:!1}}],dataZoom:[{show:!0,height:30,xAxisIndex:[0],bottom:30,start:0,end:100,handleIcon:"path://M306.1,413c0,2.2-1.8,4-4,4h-59.8c-2.2,0-4-1.8-4-4V200.8c0-2.2,1.8-4,4-4h59.8c2.2,0,4,1.8,4,4V413z",handleSize:"110%",handleStyle:{color:"#f60"},textStyle:{color:"#000"},borderColor:"#f60"},{type:"inside",show:!0,height:15,start:1,end:35}],series:[{name:"盈利",type:"bar",stack:"实收量",barMaxWidth:35,barGap:"10%",data:[],itemStyle:{normal:{color:"rgba(255,144,128,1)",label:{show:!0,textStyle:{color:"#fff"},position:"insideTop",formatter:function(t){return t.value>0?t.value:""}}}}},{name:"进价",type:"bar",stack:"实收量",data:[],itemStyle:{normal:{color:"rgba(0,191,183,1)",barBorderRadius:0,label:{show:!0,position:"top",formatter:function(t){return t.value>0?t.value:""}}}}},{name:"实收",type:"line",stack:"实收量",data:[],symbolSize:20,symbol:"circle",itemStyle:{normal:{color:"#f6383a",barBorderRadius:0,label:{show:!0,position:"top",formatter:function(t){return t.value>0?t.value:""}}}}}]}}},methods:{mountPost:function(t){this.updateRoute()},updateRoute:function(){this.syncRanklist()},onEchartReady:function(){this.updateRoute()},toggleMenu:function(t){this.pmshow=!t},searchPopClose:function(t){this.searchshow=!1},ppstarttimechange:function(t){this.ppstarttime=t},ppendtimechange:function(t){this.ppendtime=t},getShopName:function(t){var e=this.shopList;for(var n in e)if(e[n].id==t)return e[n].sName;return"未知"},switchDate:function(t){this.pmshow=!1,this.nDateType!=t&&(this.nDateType=t,this.syncRanklist())},resetfilter:function(){this.ppstarttime="2000-01-01 00:00",this.ppendtime="2100-01-01 00:00",this.ppshop=0,this.ppcat=0,this.ppmember=0,this.ppuser=0},syncRanklist:function(t){var e=this,n=0,o=0;if(t)n=this.$TimeUtils.formatDate(e.ppstarttime,this.sFomat).getTime(),o=this.$TimeUtils.formatDate(e.ppendtime,this.sFomat).getTime(),e.sResultStartTime=e.ppstarttime,e.sResultEndTime=e.ppendtime;else{var i=this.$TimeUtils.now();o=i.getTime(),e.sResultEndTime=i.format(this.sFomat),i.subtract(e.arrDateNum[this.nDateType],this.arrDateAdd[this.nDateType]),n=i.getTime(),e.sResultStartTime=i.format(this.sFomat)}if(e.$refs.posts){if(n>o)return void e.$refs.posts.toastError("开始时间不得大于截至时间！");var a={oShopID:this.ppshop,oCategoryID:this.ppcat,oMemberID:this.ppmember,oUserID:this.ppuser,nStartTime:n,nEndTime:o};e.$refs.posts.post(e.$Method.nShopDateRank,a).then(function(t){e.$refs.posts.post(e.$Method.nShopList).then(function(n){try{e.searchshow=!1,e.shopList=n.arrData.tables.shop.db;var o=t.arrData.list;if(null==o)return;var i=[];e.arrShopID=[];for(var a=[],r=[],s=[],l=0,u=0,c=0,p=0;p<o.length;p++){var h=o[p].dProfitMoney,d=o[p].dPaidMoney,m=o[p].dTotleBuyPrice;l+=h,u+=d,c+=m,i.push(e.getShopName(o[p].oShopID)),e.arrShopID.push(o[p].oShopID);try{a.push(h.toDecimal(2))}catch(t){a.push(0)}try{r.push(d.toDecimal(2))}catch(t){r.push(0)}try{s.push(m.toDecimal(2))}catch(t){s.push(0)}}e.eoption.title.text=e.sResultStartTime+" -- "+e.sResultEndTime,e.eoption.title.subtext="（共计："+o.length+"个门店）实收："+u.toDecimal(2)+" 进价："+c.toDecimal(2)+" 盈利："+l.toDecimal(2),e.eoption.xAxis[0].data=i,e.eoption.series[0].data=a,e.eoption.series[1].data=s,e.eoption.series[2].data=r}catch(t){}},function(t){})},function(t){})}}},activated:function(){document.title=this.$t("admin.shoprank.title"),this.ppstarttime=this.$TimeUtils.now().subtract(1,"years").format("YYYY-MM-DD 00:00"),this.ppendtime=this.$TimeUtils.now().format("YYYY-MM-DD 23:59"),this.updateRoute()}}}});